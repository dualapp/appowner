<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	template="../../include/templates/template1.xhtml">
	<ui:define name="content">
<h:head><title>User Registration</title>
 <link rel="stylesheet" type="text/css" href="assets/css/ace.min.css" />
 <style type="text/css">
 .ui-growl {
 position:absolute;
        
         width:400px;
         left:50%;
        
         margin-left:-200px; 

}
</style>
</h:head>
 
 <h:form id="form">
 <p:growl id="ui-growl" globalOnly="true" sticky="true" />
<body> 
 <table style="width: 98%;margin-left: 1%;margin-right: 1%;margin-bottom:5px;margin-top:5px"  class="src">
		
			<tr>
				<td> 
					<img src="#{expenseBean.str_Name}images/members.png" height="50" width="50"></img> <span class="title">Community Block Details</span>
				</td>
			</tr>
		
	</table>
 
 <div id="page3">
 <div class="gsTitleDiv">Instructions</div>
 <p:panel id="panel"  style="border:none;">
 <p>You can make changes to block names and number of houses by double clicking on them.</p>
<p>Select a block and then click on Delete Block to delete that block.</p>
<p>When you rename a block to an existing block name, both the blocks will be merged only after "Next" Button is clicked.</p>
<p>Houses which are not associated to any block will be associated to Single Building.</p>
<p>Unless the Community Setup is complete, the changes that are made will not be saved.</p></p:panel>
 <table style="overflow:hidden;border:0pt none;width: 98%;margin-left: 1%;margin-right: 1%;margin-bottom:5px"><tr><td>  
	     &#150; &#150;   <p:commandButton style="width:120px;height:25px"  process="DT" update=":form:blockDetail" icon="ui-icon-plus"  value="Create New" oncomplete="PF('blockDialog').show()" /> 
	    &#150; &#150; <p:button  style="width:120px;height:25px" outcome="instructions.xhtml" value="Back"/> 
	     &#150; &#150;<p:button  style="width:120px;height:25px" outcome="housedetails.xhtml" value="Next"/> </td>
	    </tr></table>
	    
  <p:dataTable id="DT"    selection="#{apartmentDetailsBean.selectedBlock}" rowKey="#{blockDetails.int_BlockId}" editable="true" editMode="cell" widgetVar="cellBlocks" style="width: 98%;margin-left: 1%;margin-right: 1%;margin-bottom:5px" 
             var="blockDetails"  value="#{apartmentDetailsBean.listBlockDetails}"> 
             <f:facet name="header">
           Cell Editing with Click 
       </f:facet>
       <p:ajax event="cellEdit" listener="#{apartmentDetailsBean.onCellEdit}"  update=":form:ui-growl" />
               
               <p:column  style="width:35px;text-align:center" selectionMode="single">
               
               </p:column>
                <p:column headerText="Block Name">
           <p:cellEditor>
               <f:facet name="output"><p:outputLabel value="#{blockDetails.str_BlockName}" /></f:facet>
               <f:facet name="input"><p:inputText value="#{blockDetails.str_BlockName}" style="width:96%" label="Block Name"/></f:facet>
           </p:cellEditor>
       </p:column>
        <p:column headerText="NO.Of Houses">
           <p:cellEditor>
               <f:facet name="output"><p:outputLabel value="#{blockDetails.int_NoOfHouses}" /></f:facet>
               <f:facet name="input"><p:inputText value="#{blockDetails.int_NoOfHouses}" style="width:96%"  label="Block Name"/></f:facet>
           </p:cellEditor>
       </p:column>
  <p:column>
  <f:facet name="header">
                <center>
                
                    <h:outputText value="Action" />
                    </center>
                </f:facet>
                <p:commandLink   process="DT"  update=":form:editBlockDetail" oncomplete="PF('editBlockDialog').show()" action="#{apartmentDetailsBean.getBlock1(blockDetails.int_BlockId)}">
                  <h:graphicImage  height="20" width="20" alt="Edit" value="#{expenseBean.str_Name}images/edit.jpg" title="Edit"/> 
              </p:commandLink>
               &#150; 
  <h:link outcome="deleteblock.xhtml"
	   		 onclick="return confirm('Are you sure you want to delete #{blockDetails.str_BlockName}?');" >  
	   			<p:graphicImage  height="20" width="20" alt="delete" value="#{expenseBean.str_Name}images/delete.jpg" title="Delete"/> 
	   				<f:param name="int_blockId" value="#{blockDetails.int_BlockId}" />
	   		</h:link>
 
  </p:column>
	</p:dataTable>
  
  </div>
 <p:dialog header="Add new Block" widgetVar="blockDialog"     showEffect="explode" hideEffect="bounce" resizable="false" height="250" width="500">
        <p:outputPanel id="blockDetail" style="text-align:center;">
       <table style="overflow:hidden;border:0pt none;width: 50%;margin-left: 1%;margin-right: 1%;margin-bottom:5px">
	<tr><th> 
               <p:outputLabel for="blockName"  value="Block Name" /> </th>
             
	<td><p:inputText  required="true" requiredMessage="Block Name Required"    placeholder="Enter Block Name"  id="blockName" value="#{apartmentDetailsBean.str_BlockName}"/></td>
	  <p:message  id="blockNameMsg" for="blockName" display="text"/> 
	</tr>
	<tr><th><p:outputLabel value="No. Of Houses" /> </th>
             
	<td><p:inputText    id="noofhouses" value="#{apartmentDetailsBean.int_NoOfHouse}"/></td></tr>
	
	 </table>
	 <div>
             <hr/>
              <p:commandButton ajax="true"  styleClass="btn"   update="ui-growl,blockNameMsg"  value="Submit"   actionListener="#{apartmentDetailsBean.saveBlockDetails}" oncomplete="handleRequest(xhr, status, args)" />
	  
	 
	 &#150; &#150;<p:commandButton   styleClass="btn"  value="Cancel"     action="blockdetails.xhtml" >
	 <f:ajax execute="@this" event="click"  render="@form"/>
	 </p:commandButton> 
	 </div>
	 </p:outputPanel>
	 </p:dialog>
	 <p:dialog header="Edit Block" widgetVar="editBlockDialog"     showEffect="explode" hideEffect="bounce" resizable="false" height="250" width="500">
        <p:outputPanel id="editBlockDetail" style="text-align:center;">
       <table style="overflow:hidden;border:0pt none;width: 50%;margin-left: 1%;margin-right: 1%;margin-bottom:5px">
	<tr><th> 
               <p:outputLabel for="blockName"  value="Block Name" /> </th>
             
	<td><p:inputText  id="blockName1" required="true" requiredMessage="Block Name Required"  value="#{apartmentDetailsBean.selectedBlock1.str_BlockName}"/></td>
	   <p:message  id="blockNameMsg1" for="blockName1" display="text"/> 
	</tr>
	<tr><th><p:outputLabel value="No. Of Houses" /> </th>
             
	<td><p:inputText     value="#{apartmentDetailsBean.selectedBlock1.int_NoOfHouses}"/></td></tr>
	
	 </table>
	 <div>
	 <hr/>
	  <p:commandButton  styleClass="btn"  update="ui-growl,blockNameMsg1"    value="Submit"   action="#{apartmentDetailsBean.updateBlockDetails(selectedBlock1)}"  oncomplete="handleRequest1(xhr, status, args)" />
	    
	  
	 &#150; &#150;  <p:commandButton   styleClass="btn"    value="Cancel"     action="blockdetails.xhtml" >
	 <f:ajax execute="@this" event="click"  render="@form"/>
	 </p:commandButton> 
	  
	 </div>
	 </p:outputPanel>
	 </p:dialog>
	  </body>
	 </h:form>
	  <script type="text/javascript">
    function handleRequest(xhr, status, args) 
    {
        if(args.validationFailed)
             {
        	 PF('blockDialog').show();
            
        } 
        else{
        	 history.go(0);
        	PF('blockDialog').hide();
        	
        }
        
    }
    function handleRequest1(xhr, status, args) 
    {
        if(args.validationFailed)
             {
        	 PF('editBlockDialog').show();
            
        } 
        else{
        	history.go(0);
        	PF('editBlockDialog').hide();
        	
        }
        
    }
    
</script>
	
	 </ui:define>
	 </ui:composition>